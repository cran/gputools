EXT := cu

OBJS := rinterface.o mi.o sort.o granger.o qrdecomp.o correlation.o hcluster.o distance.o matmult.o cuseful.o

OBJS13 := @OBJS13@ 

PARAMS := @EMULATION@ -I@CUDA_HOME@/include -Xcompiler "@R_INCLUDE@ @CPICFLAGS@"
PARAMS13 := @DEVICEOPTS@

LIBS :=  -L@CUDA_HOME@@CUDA_LIB_DIR@ @LIBS@ -Xlinker "@R_LIB@ @RPATHFLAG@"

TARGETS := gputools.so

CC := @CUDA_HOME@/bin/nvcc

all: $(TARGETS) 

$(TARGETS): $(OBJS) $(OBJS13)
	$(CC) -shared $(LIBS) $(OBJS) $(OBJS13) -o $@

$(OBJS): %.o: %.$(EXT)
	$(CC) -c $(PARAMS) $^ -o $@

$(OBJS13): %.o: %.$(EXT)
	$(CC) -c $(PARAMS13) $(PARAMS) $^ -o $@

clean:
	rm -rf *o

.PHONY: all clean
